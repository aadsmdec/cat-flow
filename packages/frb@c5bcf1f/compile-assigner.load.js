montageDefine("c5bcf1f","compile-assigner",{dependencies:["./compile-evaluator","./algebra","./scope"],factory:function(e,t,n){function r(e){return r.semantics.compile(e)}var i=e("./compile-evaluator"),o=e("./algebra");e("./scope");var a={type:"value"},s={type:"literal",value:!0},l={type:"literal",value:!1};n.exports=r,r.semantics={compile:function(e){var t=this.compilers;if("equals"===e.type){var n=this.compile(e.args[0]),r=this.compileEvaluator(e.args[1]);return t.equals(n,r)}if("if"===e.type){var i=this.compileEvaluator(e.args[0]),s=this.compile(e.args[1]),l=this.compile(e.args[2]);return t["if"](i,s,l)}if("and"===e.type||"or"===e.type){var u=o(e.args[0],a),c=o(e.args[1],a),h=this.compileEvaluator(e.args[0]),r=this.compileEvaluator(e.args[1]),d=this.compileEvaluator(u[1]),p=this.compileEvaluator(c[1]),n=this.compile(u[0]),f=this.compile(c[0]);return t[e.type](n,f,h,r,d,p)}if("everyBlock"===e.type){var m=this.compileEvaluator(e.args[0]),v=o(e.args[1],{type:"literal",value:!0}),g=this.compile(v[0]),_=this.compileEvaluator(v[1]);return t.everyBlock(m,g,_)}if("parent"===e.type){var b=this.compile(e.args[0]);return function(e,t){return b(e,t.parent)}}if(t.hasOwnProperty(e.type)){var y=e.args.map(this.compileEvaluator,this.compileEvaluator.semantics);return t[e.type].apply(null,y)}throw Error("Can't compile assigner for "+JSON.stringify(e.type))},compileEvaluator:i,compilers:{property:function(e,t){return function(n,r){var i=e(r);if(i){var o=t(r);null!=o&&(Array.isArray(i)?i.set(o,n):i[o]=n)}}},get:function(e,t){return function(n,r){var i=e(r);if(i){var o=t(r);null!=o&&i.set(o,n)}}},has:function(e,t){return function(n,r){var i=e(r);if(i){var o=t(r);null!=n&&(n?(i.has||i.contains).call(i,o)||i.add(o):(i.has||i.contains).call(i,o)&&(i.remove||i["delete"]).call(i,o))}}},equals:function(e,t){return function(n,r){return n?e(t(r),r):void 0}},"if":function(e,t,n){return function(r,i){var o=e(i);if(null!=o)return o?t(r,i):n(r,i)}},and:function(e,t,n,r,i,o){return function(a,l){null!=a&&(a?(e(i(s),l),t(o(s),l)):e(n(l)&&!r(l),l))}},or:function(e,t,n,r,i,o){return function(a,s){null!=a&&(a?e(n(s)||!r(s),s):(e(i(l),s),t(o(l),s)))}},rangeContent:function(e){return function(t,n){var r=e(n);r&&(t?r.swap(0,r.length,t):r.clear())}},mapContent:function(e){return function(t,n){var r=e(n);r&&(r.clear(),n.value&&r.addEach(t))}},reversed:function(e){return function(t,n){var r=e(n);r&&r.swap(0,r.length,t.reversed())}},everyBlock:function(e,t,n){return function(r,i){if(r){var o=e(i),a=n(i);o.forEach(function(e){t(a,i.nest(e))})}}}}}}});